Hallo mensen,

Leuk dat jullie naar de workshop Database management met Puppet willen komen. De bedoeling is dat we lekker hands on aan de slag gaan. Om op de avond zelf snel te kunnen starten, hebben we wat voorbereidingen gedaan. Om die optimaal te kunnen gebruiken, verwachten we ook van jullie wat voorbereidingen.

Op je PC moet de volgende software staan:

- VirtualBox (5.1.10 of hoger)
- Vagrant (bij voorkeur versie 1.9.5)
- git (bij voorkeur versie 2)

Het is handig als je toegang hebt tot github. Maak een account aan en zorg dat je in kunt loggen en repositories kunt bekijken. We gaan werken op basis van de repo https://github.com/enterprisemodules/amis_demo. Kijk alvast of je daarbij kan. en maak een clone hiervan op je eigen PC.

```
$ git clone https://github.com/enterprisemodules/amis_demo.git
```

Omdat het inspoelen van een nieuwe database ca. een half uur kost, hebben we dat alvast voor je gedaan. Om het systeem te starten gebruik het volgende commando:

```
$ vagrant up ml-db122
```

Voor het downloaden van de box file voor Vagrant, moet je voldoende tijd inruimen. Het is een grote box (bijna 5 Gb).


De log ziet er ongeveer zo uit:
```
==> ml-db122: Box 'enterprisemodules/amis_demo' could not be found. Attempting to find and install...
    ml-db122: Box Provider: virtualbox
    ml-db122: Box Version: >= 0
==> ml-db122: Loading metadata for box 'enterprisemodules/amis_demo'
    ml-db122: URL: https://atlas.hashicorp.com/enterprisemodules/amis_demo
==> ml-db122: Adding box 'enterprisemodules/amis_demo' (v0.1) for provider: virtualbox
    ml-db122: Downloading: https://atlas.hashicorp.com/enterprisemodules/boxes/amis_demo/versions/0.1/providers/virtualbox.box
==> ml-db122: Importing base box 'enterprisemodules/amis_demo'...
==> ml-db122: Matching MAC address for NAT networking...
==> ml-db122: Checking if box 'enterprisemodules/amis_demo' is up to date...
==> ml-db122: Setting the name of the VM: amis_demo_ml-db122_1497378685199_70138
==> ml-db122: Fixed port collision for 22 => 2222. Now on port 2201.
==> ml-db122: Clearing any previously set network interfaces...
==> ml-db122: Preparing network interfaces based on configuration...
  ml-db122: Adapter 1: nat
  ml-db122: Adapter 2: hostonly
  ml-db122: Adapter 3: intnet
==> ml-db122: Forwarding ports...
  ml-db122: 22 (guest) => 2201 (host) (adapter 1)
==> ml-db122: Running 'pre-boot' VM customizations...
==> ml-db122: Booting VM...
==> ml-db122: Waiting for machine to boot. This may take a few minutes...
  ml-db122: SSH address: 127.0.0.1:2201
  ml-db122: SSH username: vagrant
  ml-db122: SSH auth method: private key
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
  ml-db122: Warning: Connection reset. Retrying...
  ml-db122: Warning: Remote connection disconnect. Retrying...
==> ml-db122: Machine booted and ready!
==> ml-db122: Checking for guest additions in VM...
  ml-db122: The guest additions on this VM do not match the installed version of
  ml-db122: VirtualBox! In most cases this is fine, but in rare cases it can
  ml-db122: prevent things such as shared folders from working properly. If you see
  ml-db122: shared folder errors, please make sure the guest additions within the
  ml-db122: virtual machine match the version of VirtualBox you have installed on
  ml-db122: your host and reload your VM.
  ml-db122:
  ml-db122: Guest Additions Version: 5.0.14
  ml-db122: VirtualBox Version: 5.1
==> ml-db122: Setting hostname...
==> ml-db122: Configuring and enabling network interfaces...
  ml-db122: SSH address: 127.0.0.1:2201
  ml-db122: SSH username: vagrant
  ml-db122: SSH auth method: private key
==> ml-db122: Mounting shared folders...
  ml-db122: /vagrant => /Users/hajee/Dropbox (Enterprise Modules)/enterprisemodules/examples/amis_demo
==> ml-db122: Running provisioner: shell...
  ml-db122: Running: inline script
==> ml-db122: Running provisioner: shell...
  ml-db122: Running: /var/folders/r0/r9sl0ryd1l34fcxy5v3wzgfc0000gn/T/vagrant-shell20170613-53873-joq7w3.sh
==> ml-db122: Installing required gems
==> ml-db122: Successfully installed activesupport-4.2.7.1
==> ml-db122: Successfully installed librarian-puppet-2.2.3
==> ml-db122: Successfully installed awesome_print-1.7.0
==> ml-db122: 3 gems installed
==> ml-db122: Loaded plugins: fastestmirror
==> ml-db122: Determining fastest mirrors
==> ml-db122:  * base: mirror.i3d.net
==> ml-db122:  * extras: mirror.colocenter.nl
==> ml-db122:  * updates: centos.ams.host-engine.com
==> ml-db122: Package git-1.8.3.1-6.el7_2.1.x86_64 already installed and latest version
==> ml-db122: Nothing to do
==> ml-db122: Installing required puppet modules
==> ml-db122: Setting up hiera directories
==> ml-db122: Setting up Puppet module directories
==> ml-db122: Setting up Puppet manifest directories
==> ml-db122: Running provisioner: shell...
  ml-db122: Running: inline script
==> ml-db122: Info: Loading facts
==> ml-db122: Info: Loading facts
==> ml-db122: Info: Loading facts
==> ml-db122: Info: Loading facts
==> ml-db122: Info: Loading facts
==> ml-db122: Info: oracle_exists: oracle_exists /u01/app/oracle/product/12.2.0.1/db_home1;
==> ml-db122: Info: oracle_exists: oracle_exists compare /u01/app/oracle/product/12.2.0.1/db_home1; with /u01/app/oracle/product/12.2.0.1/db_home1
==> ml-db122: Info: oracle_exists: oracle_exists return true
==> ml-db122: Notice: Compiled catalog for db122.example.com in environment production in 2.73 seconds
==> ml-db122: Info: Applying configuration version '1497378792'
==> ml-db122: Notice: /Stage[main]/Profile::Base::Hosts/Host[master.example.com]/host_aliases: host_aliases changed 'puppet master' to 'master puppet'
==> ml-db122: Info: Computing checksum on file /etc/hosts
==> ml-db122: Info: FileBucket got a duplicate file {md5}67f3ce3eba41a58b18a7e0a84f2038ca
==> ml-db122: Notice: /Stage[main]/Profile::Base::Hosts/Host[db112.example.com]/ensure: created
==> ml-db122: Notice: /Stage[main]/Profile::Base::Hosts/Host[db121.example.com]/ensure: created
==> ml-db122: Info: configure oracle folders for oracle structure 12.2.0.1
==> ml-db122: Info: create the following directories: /u01/app/oracle, /u01/app/oracle/oraInventory, /install
==> ml-db122: Info: creating directory /u01/app/oracle
==> ml-db122: Info: creating directory /install
==> ml-db122: Info: creating directory /u01/app/oracle/oraInventory
==> ml-db122: Info: Setting oracle ownership for /u01/app/oracle/oraInventory with 0775
==> ml-db122: Info: Setting oracle ownership for /u01/app/oracle with 0775
==> ml-db122: Info: Setting public permissions 0777 for /install
==> ml-db122: Notice: /Stage[main]/Profile::Oradb::Software/Ora_install::Installdb[linuxx64_12201_database]/Db_directory_structure[oracle structure 12.2.0.1]/ensure: defined 'ensure' as 'present'
==> ml-db122: Notice: Running on VM. You are free to use ora_config on a WorkStation VM. Check the license requirements on http://www.enterprisemodules.com/ for details.
==> ml-db122: Notice: Applied catalog in 8.86 seconds
```

Als dit niet zo is, neem dan vooraf contact met ons op.

Als je alvast wat wil rondkijken en experimenteren, kun je als volgt inloggen:

```
$ vagrant ssh ml-db122
$ sudo -i # Nu ben je root
```

Als je genoeg hebt, kun je de VM stoppen met:

```
$ vagrant halt ml-db122
```

Als je de VM verwijderen met:

```
$ vagrant destroy ml-db122
```

Tot de 28e juni.

Bert
